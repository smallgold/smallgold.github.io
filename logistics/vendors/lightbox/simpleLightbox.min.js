!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof module&&module.exports?module.exports=t(require("jquery")):t(jQuery)}(function(o){function i(t){this.init.apply(this,arguments)}var e=0,t=o("html"),n=o(document),l=o(window);return i.defaults={elementClass:"",elementLoadingClass:"slbLoading",htmlClass:"slbActive",closeBtnClass:"",nextBtnClass:"",prevBtnClass:"",loadingTextClass:"",closeBtnCaption:"Close",nextBtnCaption:"Next",prevBtnCaption:"Previous",loadingCaption:"Loading...",bindToItems:!0,closeOnOverlayClick:!0,closeOnEscapeKey:!0,nextOnImageClick:!0,showCaptions:!0,captionAttribute:"title",urlAttribute:"href",startAt:0,loadingTimeout:100,appendTarget:"body",beforeSetContent:null,beforeClose:null,beforeDestroy:null,videoRegex:new RegExp(/youtube.com|vimeo.com/)},o.extend(i.prototype,{init:function(t){this.options=o.extend({},i.defaults,t),this.ens=".slb"+ ++e,this.items=[],this.captions=[];var s=this;this.options.$items?(this.$items=this.options.$items,this.$items.each(function(){var t=o(this);s.items.push(t.attr(s.options.urlAttribute)),s.captions.push(t.attr(s.options.captionAttribute))}),this.options.bindToItems&&this.$items.on("click"+this.ens,function(t){t.preventDefault(),s.showPosition(s.$items.index(o(t.currentTarget)))})):this.options.items&&(this.items=this.options.items),this.options.captions&&(this.captions=this.options.captions)},next:function(){return this.showPosition(this.currentPosition+1)},prev:function(){return this.showPosition(this.currentPosition-1)},normalizePosition:function(t){return t>=this.items.length?t=0:t<0&&(t=this.items.length-1),t},showPosition:function(t){return this.currentPosition=this.normalizePosition(t),this.setupLightboxHtml().prepareItem(this.currentPosition,this.setContent).show()},loading:function(t){var s=this;t?this.loadingTimeout=setTimeout(function(){s.$el.addClass(s.options.elementLoadingClass),s.$content.html('<p class="slbLoadingText '+s.options.loadingTextClass+'">'+s.options.loadingCaption+"</p>"),s.show()},this.options.loadingTimeout):(this.$el&&this.$el.removeClass(this.options.elementLoadingClass),clearTimeout(this.loadingTimeout))},prepareItem:function(t,s){var e,i=this,n=this.items[t];return this.loading(!0),this.options.videoRegex.test(n)?s.call(i,o('<div class="slbIframeCont"><iframe class="slbIframe" frameborder="0" allowfullscreen src="'+n+'"></iframe></div>')):(e=o('<div class="slbImageWrap"><img class="slbImage" src="'+n+'" /></div>'),this.$currentImage=e.find(".slbImage"),this.options.showCaptions&&this.captions[t]&&e.append('<div class="slbCaption">'+this.captions[t]+"</div>"),this.loadImage(n,function(){i.setImageDimensions(),s.call(i,e),i.loadImage(i.items[i.normalizePosition(i.currentPosition+1)])})),this},loadImage:function(t,s){var e;this.options.videoRegex.test(t)||(e=new Image,s&&(e.onload=s),e.src=t)},setupLightboxHtml:function(){var t=this.options;return this.$el||(this.$el=o('<div class="slbElement '+t.elementClass+'"><div class="slbOverlay"></div><div class="slbWrapOuter"><div class="slbWrap"><div class="slbContentOuter"><div class="slbContent"></div><button type="button" title="'+t.closeBtnCaption+'" class="slbCloseBtn '+t.closeBtnClass+'">Ã—</button></div></div></div></div>'),1<this.items.length&&o('<div class="slbArrows"><button type="button" title="'+t.prevBtnCaption+'" class="prev slbArrow'+t.prevBtnClass+'">'+t.prevBtnCaption+'</button><button type="button" title="'+t.nextBtnCaption+'" class="next slbArrow'+t.nextBtnClass+'">'+t.nextBtnCaption+"</button></div>").appendTo(this.$el.find(".slbContentOuter")),this.$content=this.$el.find(".slbContent")),this.$content.empty(),this},show:function(){return this.modalInDom||(this.$el.appendTo(o(this.options.appendTarget)),t.addClass(this.options.htmlClass),this.setupLightboxEvents(),this.modalInDom=!0),this},setContent:function(t){t=o(t);return this.loading(!1),this.setupLightboxHtml(),this.options.beforeSetContent&&this.options.beforeSetContent(t,this),this.$content.html(t),this},setImageDimensions:function(){this.$currentImage&&this.$currentImage.css("max-height",l.height()+"px")},setupLightboxEvents:function(){var s=this;this.lightboxEventsSetuped||(this.$el.on("click"+this.ens,function(t){t=o(t.target);t.is(".slbCloseBtn")||s.options.closeOnOverlayClick&&t.is(".slbWrap")?s.close():t.is(".slbArrow")?t.hasClass("next")?s.next():s.prev():s.options.nextOnImageClick&&1<s.items.length&&t.is(".slbImage")&&s.next()}),n.on("keyup"+this.ens,function(t){s.options.closeOnEscapeKey&&27===t.keyCode&&s.close(),1<s.items.length&&(39!==t.keyCode&&68!==t.keyCode||s.next(),37===t.keyCode||65===t.keyCode)&&s.prev()}),l.on("resize"+this.ens,function(){s.setImageDimensions()}),this.lightboxEventsSetuped=!0)},close:function(){this.modalInDom&&(this.options.beforeClose&&this.options.beforeClose(this),this.$el&&this.$el.off(this.ens),n.off(this.ens),l.off(this.ens),this.lightboxEventsSetuped=!1,this.$el.detach(),t.removeClass(this.options.htmlClass),this.modalInDom=!1)},destroy:function(){this.close(),this.options.beforeDestroy&&this.options.beforeDestroy(this),this.$items&&this.$items.off(this.ens),this.$el&&this.$el.remove()}}),i.open=function(t){var s=new i(t);return t.content?s.setContent(t.content).show():s.showPosition(s.options.startAt)},o.fn.simpleLightbox=function(t){var s,e=this;return this.each(function(){o.data(this,"simpleLightbox")||(s=s||new i(o.extend({},t,{$items:e})),o.data(this,"simpleLightbox",s))})},o.simpleLightbox=o.SimpleLightbox=i,o});