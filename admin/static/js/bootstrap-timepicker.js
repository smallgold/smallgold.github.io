!function(s){"use strict";function h(t,i){this.$element=s(t),this.options=s.extend({},s.fn.timepicker.defaults,i,this.$element.data()),this.minuteStep=this.options.minuteStep||this.minuteStep,this.secondStep=this.options.secondStep||this.secondStep,this.showMeridian=this.options.showMeridian||this.showMeridian,this.showSeconds=this.options.showSeconds||this.showSeconds,this.showInputs=this.options.showInputs||this.showInputs,this.disableFocus=this.options.disableFocus||this.disableFocus,this.template=this.options.template||this.template,this.modalBackdrop=this.options.modalBackdrop||this.modalBackdrop,this.defaultTime=this.options.defaultTime||this.defaultTime,this.open=!1,this.init()}h.prototype={constructor:h,init:function(){this.$element.parent().hasClass("input-group")?(this.$element.parent(".input-group").find(".btn").on("click",s.proxy(this.showWidget,this)),this.$element.on({focus:s.proxy(this.highlightUnit,this),click:s.proxy(this.highlightUnit,this),keypress:s.proxy(this.elementKeypress,this),blur:s.proxy(this.blurElement,this)})):this.template?this.$element.on({focus:s.proxy(this.showWidget,this),click:s.proxy(this.showWidget,this),blur:s.proxy(this.blurElement,this)}):this.$element.on({focus:s.proxy(this.highlightUnit,this),click:s.proxy(this.highlightUnit,this),keypress:s.proxy(this.elementKeypress,this),blur:s.proxy(this.blurElement,this)}),this.$widget=s(this.getTemplate()).appendTo("body"),this.$widget.on("click",s.proxy(this.widgetClick,this)),this.showInputs&&this.$widget.find("input").on({click:function(){this.select()},keypress:s.proxy(this.widgetKeypress,this),change:s.proxy(this.updateFromWidgetInputs,this)}),this.setDefaultTime(this.defaultTime)},showWidget:function(t){t.stopPropagation(),t.preventDefault(),this.open||(this.$element.trigger("show"),this.disableFocus&&this.$element.blur(),t=s.extend({},this.$element.offset(),{height:this.$element[0].offsetHeight}),this.updateFromElementVal(),s("html").trigger("click.timepicker.data-api").one("click.timepicker.data-api",s.proxy(this.hideWidget,this)),"modal"===this.template?this.$widget.modal("show").on("hidden",s.proxy(this.hideWidget,this)):(this.$widget.css({top:t.top+t.height,left:t.left}),this.open||this.$widget.addClass("open")),this.open=!0,this.$element.trigger("shown"))},hideWidget:function(){this.$element.trigger("hide"),"modal"===this.template?this.$widget.modal("hide"):this.$widget.removeClass("open"),this.open=!1,this.$element.trigger("hidden")},widgetClick:function(t){t.stopPropagation(),t.preventDefault();t=s(t.target).closest("a").data("action");t&&(this[t](),this.update())},widgetKeypress:function(t){var i=s(t.target).closest("input").attr("name");switch(t.keyCode){case 9:this.showMeridian?"meridian"==i&&this.hideWidget():this.showSeconds?"second"==i&&this.hideWidget():"minute"==i&&this.hideWidget();break;case 27:this.hideWidget();break;case 38:switch(i){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian()}this.update();break;case 40:switch(i){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian()}this.update()}},elementKeypress:function(t){this.$element.get(0);switch(t.keyCode){case 0:break;case 9:this.updateFromElementVal(),this.showMeridian?"meridian"!=this.highlightedUnit&&(t.preventDefault(),this.highlightNextUnit()):this.showSeconds?"second"!=this.highlightedUnit&&(t.preventDefault(),this.highlightNextUnit()):"minute"!=this.highlightedUnit&&(t.preventDefault(),this.highlightNextUnit());break;case 27:this.updateFromElementVal();break;case 37:this.updateFromElementVal(),this.highlightPrevUnit();break;case 38:switch(this.highlightedUnit){case"hour":this.incrementHour();break;case"minute":this.incrementMinute();break;case"second":this.incrementSecond();break;case"meridian":this.toggleMeridian()}this.updateElement();break;case 39:this.updateFromElementVal(),this.highlightNextUnit();break;case 40:switch(this.highlightedUnit){case"hour":this.decrementHour();break;case"minute":this.decrementMinute();break;case"second":this.decrementSecond();break;case"meridian":this.toggleMeridian()}this.updateElement()}0!==t.keyCode&&8!==t.keyCode&&9!==t.keyCode&&46!==t.keyCode&&t.preventDefault()},setValues:function(t){var i,e;this.showMeridian?(e=(i=t.split(" "))[0].split(":"),this.meridian=i[1]):e=t.split(":"),this.hour=parseInt(e[0],10),this.minute=parseInt(e[1],10),this.second=parseInt(e[2],10),isNaN(this.hour)&&(this.hour=0),isNaN(this.minute)&&(this.minute=0),this.showMeridian?(12<this.hour?this.hour=12:this.hour<1&&(this.hour=1),"am"==this.meridian||"a"==this.meridian?this.meridian="AM":"pm"!=this.meridian&&"p"!=this.meridian||(this.meridian="PM"),"AM"!=this.meridian&&"PM"!=this.meridian&&(this.meridian="AM")):24<=this.hour?this.hour=23:this.hour<0&&(this.hour=0),this.minute<0?this.minute=0:60<=this.minute&&(this.minute=59),this.showSeconds&&(isNaN(this.second)||this.second<0?this.second=0:60<=this.second&&(this.second=59)),""!=this.$element.val()&&this.updateElement(),this.updateWidget()},setMeridian:function(t){"a"==t||"am"==t||"AM"==t?this.meridian="AM":"p"==t||"pm"==t||"PM"==t?this.meridian="PM":this.updateWidget(),this.updateElement()},setDefaultTime:function(t){var i,e,s,h;t?("current"===t?(i=(s=new Date).getHours(),e=Math.floor(s.getMinutes()/this.minuteStep)*this.minuteStep,s=Math.floor(s.getSeconds()/this.secondStep)*this.secondStep,h="AM",this.showMeridian&&(0===i?i=12:h=12<=i?(12<i&&(i-=12),"PM"):"AM"),this.hour=i,this.minute=e,this.second=s,this.meridian=h):"value"===t?this.setValues(this.$element.val()):this.setValues(t),""!=this.$element.val()&&this.updateElement(),this.updateWidget()):(this.hour=0,this.minute=0,this.second=0)},formatTime:function(t,i,e,s){return e=e<10?"0"+e:e,(t=t<10?"0"+t:t)+":"+(i=i<10?"0"+i:i)+(this.showSeconds?":"+e:"")+(this.showMeridian?" "+s:"")},getTime:function(){return this.formatTime(this.hour,this.minute,this.second,this.meridian)},setTime:function(t){this.setValues(t),this.update()},update:function(){this.updateElement(),this.updateWidget()},blurElement:function(){this.highlightedUnit=void 0,this.updateFromElementVal()},updateElement:function(){var t=this.getTime();switch(this.$element.val(t).change(),this.highlightedUnit){case"hour":this.highlightHour();break;case"minute":this.highlightMinute();break;case"second":this.highlightSecond();break;case"meridian":this.highlightMeridian()}},updateWidget:function(){this.showInputs?(this.$widget.find("input.bootstrap-timepicker-hour").val(this.hour<10?"0"+this.hour:this.hour),this.$widget.find("input.bootstrap-timepicker-minute").val(this.minute<10?"0"+this.minute:this.minute),this.showSeconds&&this.$widget.find("input.bootstrap-timepicker-second").val(this.second<10?"0"+this.second:this.second),this.showMeridian&&this.$widget.find("input.bootstrap-timepicker-meridian").val(this.meridian)):(this.$widget.find("span.bootstrap-timepicker-hour").text(this.hour),this.$widget.find("span.bootstrap-timepicker-minute").text(this.minute<10?"0"+this.minute:this.minute),this.showSeconds&&this.$widget.find("span.bootstrap-timepicker-second").text(this.second<10?"0"+this.second:this.second),this.showMeridian&&this.$widget.find("span.bootstrap-timepicker-meridian").text(this.meridian))},updateFromElementVal:function(t){var i=this.$element.val();i&&(this.setValues(i),this.updateWidget())},updateFromWidgetInputs:function(){var t=s("input.bootstrap-timepicker-hour",this.$widget).val()+":"+s("input.bootstrap-timepicker-minute",this.$widget).val()+(this.showSeconds?":"+s("input.bootstrap-timepicker-second",this.$widget).val():"")+(this.showMeridian?" "+s("input.bootstrap-timepicker-meridian",this.$widget).val():"");this.setValues(t)},getCursorPosition:function(){var t,i,e=this.$element.get(0);return"selectionStart"in e?e.selectionStart:document.selection?(e.focus(),t=document.selection.createRange(),i=document.selection.createRange().text.length,t.moveStart("character",-e.value.length),t.text.length-i):void 0},highlightUnit:function(){this.$element.get(0);this.position=this.getCursorPosition(),0<=this.position&&this.position<=2?this.highlightHour():3<=this.position&&this.position<=5?this.highlightMinute():6<=this.position&&this.position<=8?this.showSeconds?this.highlightSecond():this.highlightMeridian():9<=this.position&&this.position<=11&&this.highlightMeridian()},highlightNextUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMinute();break;case"minute":this.showSeconds?this.highlightSecond():this.highlightMeridian();break;case"second":this.highlightMeridian();break;case"meridian":this.highlightHour()}},highlightPrevUnit:function(){switch(this.highlightedUnit){case"hour":this.highlightMeridian();break;case"minute":this.highlightHour();break;case"second":this.highlightMinute();break;case"meridian":this.showSeconds?this.highlightSecond():this.highlightMinute()}},highlightHour:function(){this.highlightedUnit="hour",this.$element.get(0).setSelectionRange(0,2)},highlightMinute:function(){this.highlightedUnit="minute",this.$element.get(0).setSelectionRange(3,5)},highlightSecond:function(){this.highlightedUnit="second",this.$element.get(0).setSelectionRange(6,8)},highlightMeridian:function(){this.highlightedUnit="meridian",this.showSeconds?this.$element.get(0).setSelectionRange(9,11):this.$element.get(0).setSelectionRange(6,8)},incrementHour:function(){if(this.showMeridian)if(11===this.hour)this.toggleMeridian();else if(12===this.hour)return this.hour=1;if(23===this.hour)return this.hour=0;this.hour=this.hour+1},decrementHour:function(){if(this.showMeridian){if(1===this.hour)return this.hour=12;12===this.hour&&this.toggleMeridian()}if(0===this.hour)return this.hour=23;this.hour=this.hour-1},incrementMinute:function(){var t=this.minute+this.minuteStep-this.minute%this.minuteStep;59<t?(this.incrementHour(),this.minute=t-60):this.minute=t},decrementMinute:function(){var t=this.minute-this.minuteStep;t<0?(this.decrementHour(),this.minute=60+t):this.minute=t},incrementSecond:function(){var t=this.second+this.secondStep-this.second%this.secondStep;59<t?(this.incrementMinute(),this.second=t-60):this.second=t},decrementSecond:function(){var t=this.second-this.secondStep;t<0?(this.decrementMinute(),this.second=60+t):this.second=t},toggleMeridian:function(){this.meridian="AM"===this.meridian?"PM":"AM",this.update()},getTemplate:function(){if(this.options.templates[this.options.template])return this.options.templates[this.options.template];s=this.showInputs?(t='<input type="text" name="hour" class="bootstrap-timepicker-hour" maxlength="2"/>',i='<input type="text" name="minute" class="bootstrap-timepicker-minute" maxlength="2"/>',e='<input type="text" name="second" class="bootstrap-timepicker-second" maxlength="2"/>','<input type="text" name="meridian" class="bootstrap-timepicker-meridian" maxlength="2"/>'):(t='<span class="bootstrap-timepicker-hour"></span>',i='<span class="bootstrap-timepicker-minute"></span>',e='<span class="bootstrap-timepicker-second"></span>','<span class="bootstrap-timepicker-meridian"></span>');var t,i,e,s,h,n='<table class="'+(this.showSeconds?"show-seconds":"")+" "+(this.showMeridian?"show-meridian":"")+'"><tr><td><a href="#" data-action="incrementHour"><i class="icon-angle-up"></i></a></td><td class="separator">&nbsp;</td><td><a href="#" data-action="incrementMinute"><i class="icon-angle-up"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="incrementSecond"><i class="icon-angle-up"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td class="meridian-column"><a href="#" data-action="toggleMeridian"><i class="icon-angle-up"></i></a></td>':"")+"</tr><tr><td>"+t+'</td> <td class="separator">:</td><td>'+i+"</td> "+(this.showSeconds?'<td class="separator">:</td><td>'+e+"</td>":"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td>'+s+"</td>":"")+'</tr><tr><td><a href="#" data-action="decrementHour"><i class="icon-angle-down"></i></a></td><td class="separator"></td><td><a href="#" data-action="decrementMinute"><i class="icon-angle-down"></i></a></td>'+(this.showSeconds?'<td class="separator">&nbsp;</td><td><a href="#" data-action="decrementSecond"><i class="icon-angle-down"></i></a></td>':"")+(this.showMeridian?'<td class="separator">&nbsp;</td><td><a href="#" data-action="toggleMeridian"><i class="icon-angle-down"></i></a></td>':"")+"</tr></table>";switch(this.options.template){case"modal":h='<div class="bootstrap-timepicker modal hide fade in" style="top: 30%; margin-top: 0; width: 200px; margin-left: -100px;" data-backdrop="'+(this.modalBackdrop?"true":"false")+'"><div class="modal-header"><a href="#" class="close" data-dismiss="modal">×</a><h3>Pick a Time</h3></div><div class="modal-content">'+n+'</div><div class="modal-footer"><a href="#" class="btn btn-primary" data-dismiss="modal">Ok</a></div></div>';break;case"dropdown":h='<div class="bootstrap-timepicker dropdown-menu">'+n+"</div>"}return h}},s.fn.timepicker=function(e){return this.each(function(){var t=s(this),i=t.data("timepicker");i||t.data("timepicker",i=new h(this,"object"==typeof e&&e)),"string"==typeof e&&i[e]()})},s.fn.timepicker.defaults={minuteStep:15,secondStep:15,disableFocus:!1,defaultTime:"current",showSeconds:!1,showInputs:!0,showMeridian:!0,template:"dropdown",modalBackdrop:!1,templates:{}},s.fn.timepicker.Constructor=h}(window.jQuery);